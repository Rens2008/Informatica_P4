<!DOCTYPE html>
<html lang="nl"></html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Rens Game site">
    <meta name="keywords" content="games, HTML, CSS, JavaScript">
    <meta name="author" content="Rens Windhorst">
    <title>Weer</title>
    <link rel="stylesheet" href="Style.css">
</head>
<div class="header">
    <h1>Het weer in Alphen aan den Rijn</h1>
</div>
<div class="navbar">
    <a href="Index.html">Home</a>
    <a href="../Games/Games.html">Games</a>
    <a href="Weather.html">Weer</a>
</div>
<body>
    <iframe src="https://gadgets.buienradar.nl/gadget/zoommap/?lat=52.12917&lng=4.65546&overname=2&zoom=8&naam=Alphen aan den Rijn&size=2b&voor=0" scrolling=no width=330 height=330 frameborder=no></iframe>
    <p>Bekijk het weer in Alphen aan den Rijn</p>

    <h1>Upload a file to scan for viruses (max: 3 mb)</h1>
    <input type="file" id="fileInput">
    <button onclick="scanFile()">Scan File</button>
    <div id="scanStatus" style="margin-top: 10px;"></div>

    <script>
        function scanFile() {
            const fileInput = document.getElementById('fileInput');
            const statusDiv = document.getElementById('scanStatus');
            statusDiv.textContent = ''; // Clear previous status

            if (fileInput.files.length === 0) {
                statusDiv.textContent = "Please select a file to scan.";
                alert("Please select a file to scan."); // Keeping alert for immediate feedback
                return;
            }

            var data = new FormData();
            data.append("inputFile", fileInput.files[0], fileInput.files[0].name);
            
            var xhr = new XMLHttpRequest();
            xhr.withCredentials = false; 

            xhr.addEventListener("readystatechange", function() {
                if(this.readyState === 4) {
                    console.log("Response:", this.responseText);
                    if (xhr.status === 200) {
                        try {
                            const response = JSON.parse(this.responseText);
                            if (response.CleanResult) {
                                statusDiv.textContent = "File is clean!";
                            } else {
                                statusDiv.textContent = "Virus detected! " + (response.FoundViruses ? response.FoundViruses.map(v => v.VirusName).join(', ') : 'Unknown virus.');
                            }
                        } catch (e) {
                            console.error("Error parsing response:", e);
                            statusDiv.textContent = "Error processing scan result.";
                        }
                    }
                }
            });

            xhr.open("POST", "https://api.cloudmersive.com/virus/scan/file");

            xhr.setRequestHeader("Apikey", "ba661b46-713a-47ce-985a-89d4d55aff72"); 

            xhr.onload = function() {
                if (xhr.status === 200) {
                    console.log("File scanned successfully. Status:", xhr.status);
                } else {
                    console.error("Error scanning file. Status:", xhr.status, "StatusText:", xhr.statusText, "Response:", xhr.responseText);
                    statusDiv.textContent = "Error scanning file: " + xhr.statusText + (xhr.responseText ? ` - ${xhr.responseText}` : '');
                }
            };

            xhr.onerror = function() {
                console.error("Network error occurred while trying to scan the file.");
                statusDiv.textContent = "Network error. Please check your connection and try again.";
            };
            
            statusDiv.textContent = "Scanning file, please wait...";
            console.log("Sending file for scan...");
            xhr.send(data);
        }
    </script>
    <!-- If you prefer to keep the JavaScript in a separate file: -->
    <!-- <script src="virus.js"></script> -->
</body>
</html>
